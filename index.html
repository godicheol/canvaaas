<!DOCTYPE html>
<html>
<head>
<title>canvaaas</title>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- ! -->
<meta name="viewport" content="width=device-width, initial-scale=1"> 
<link rel='stylesheet' href='./dist/canvaaas.css' />
<script src="./dist/canvaaas.js"></script>
<!-- ! -->

<style>
	html,
	body,
	div{
		margin: 0;
		padding: 0;
	}

	#container{
		padding: 24px;
		overflow: hidden;
		/*background-color: #000;*/
	}

	table{
		margin: 0 auto;
		text-align: right;
	}
</style>
</head>
<body style="">

	<!-- main 1, empty -->
	<div id="container"></div>

	<!-- main 2, has inner -->
	<!-- <div id="container">
		<img src="/img/3.jpeg" alt="">
		<img src="/img/2.jpeg" alt="">
		<img src="/img/1.jpeg" alt="">
		<img src="/img/4.jpeg" alt="">
	</div> -->

	<table>
		<tr>
			<td>X:<input id="axisX" name="axisX" type="text"></td>
			<td>Y:<input id="axisY" name="axisY" type="text"></td>
		</tr>
		<tr>
			<td>Width:<input id="width" name="width" type="text"></td>
			<td>Height:<input id="height" name="height" type="text"></td>
		</tr>
		<tr>
			<td>Rotate:<input id="rotate" name="rotate" type="text"></td>
		</tr>
		<tr>
			<td>ScaleX<input id="scaleX" name="scaleX" type="text"></td>
			<td>ScaleY<input id="scaleY" name="scaleY" type="text"></td>
		</tr>
		<tr>
			<td>Opacity<input id="opacity" name="opacity" type="text"></td>
			<td>Index<input id="index" name="index" type="text"></td>
		</tr>
		<tr>
			<td>Focusable<input id="focusable" name="focusable" type="text"></td>
			<td>Editable<input id="editable" name="editable" type="text"></td>
		</tr>
		<tr>
			<td>Drawable<input id="drawable" name="drawable" type="text"></td>
		</tr>
	</table>

	<div id="buttons">
		<!-- buttons -->
		<input type="file" onchange="
			canvaaas.uploadFiles(this)
		" multiple>
		<button type="button" onclick="
			canvaaas.uploadUrls(['/img/1.jpeg'])
		">uploadUrls(url, cb)</button>
		<button type="button" onclick="
			canvaaas.uploadUrls(['/img/3.jpg', '/img/3.jpeg', '/img/4.png', '/img/3.png'], null)
		">uploadUrls(array, cb)</button>
		<button type="button" onclick="
			canvaaas.uploadUrls(['/img/1.svg'], null)
		">uploadUrls(url, cb)</button>
		//
		<button type="button" onclick="canvaaas.moveX(canvaaas.this(), 10)">moveX(id, 10, cb)</button>
		<button type="button" onclick="canvaaas.moveX(canvaaas.this(), -10)">moveX(id, -10, cb)</button>
		<button type="button" onclick="canvaaas.moveY(canvaaas.this(), 10)">moveY(id, 10, cb)</button>
		<button type="button" onclick="canvaaas.moveY(canvaaas.this(), -10)">moveY(id, -10, cb)</button>
		<button type="button" onclick="canvaaas.moveTo(canvaaas.this(), 0, 0)">moveTo(id, 0, 0, cb)</button>
		<button type="button" onclick="canvaaas.moveTo(canvaaas.this(), 0.5, 0.5)">moveTo(id, 0.5, 0.5, cb)</button>
		<button type="button" onclick="canvaaas.moveTo(canvaaas.this(), 1, 1)">moveTo(id, 1, 1, cb)</button>
		//
		<button type="button" onclick="canvaaas.zoom(canvaaas.this(), 0.1)">zoom(id, 0.1, cb)</button>
		<button type="button" onclick="canvaaas.zoom(canvaaas.this(), -0.1)">zoom(id, -0.1, cb)</button>
		<button type="button" onclick="canvaaas.zoomTo(canvaaas.this(), 0.01)">zoomTo(id, 0.01, cb)</button>
		<button type="button" onclick="canvaaas.zoomTo(canvaaas.this(), 'cover')">zoomTo(id, 'cover', cb)</button>
		<button type="button" onclick="canvaaas.zoomTo(canvaaas.this(), 'contain')">zoomTo(id, 'contain', cb)</button>
		//
		<button type="button" onclick="canvaaas.rotate(canvaaas.this(), 45)">rotate(id, 45, cb)</button>
		<button type="button" onclick="canvaaas.rotateTo(canvaaas.this(), 45)">rotateTo(id, 45, cb)</button>
		//
		<button type="button" onclick="canvaaas.flipX(canvaaas.this())">flipX(id, cb)</button>
		<button type="button" onclick="canvaaas.flipY(canvaaas.this())">flipY(id, cb)</button>
		//
		<button type="button" onclick="canvaaas.opacityTo(canvaaas.this(), 0)">opacityTo(id, 0, cb)</button>
		<button type="button" onclick="canvaaas.opacityTo(canvaaas.this(), 0.5)">opacityTo(id, 0.5, cb)</button>
		<button type="button" onclick="canvaaas.opacityTo(canvaaas.this(), 1)">opacityTo(id, 1, cb)</button>
		//
		<button type="button" onclick="canvaaas.indexUp(canvaaas.this())">indexUp(id, cb)</button>
		<button type="button" onclick="canvaaas.indexDown(canvaaas.this())">indexDown(id, cb)</button>
		<button type="button" onclick="canvaaas.indexTo(canvaaas.this(), 1)">indexTo(id, 1, cb)</button>
		<button type="button" onclick="canvaaas.indexTo(canvaaas.this(), 1000)">indexTo(id, 1000, cb)</button>
		//
		<button type="button" onclick="canvaaas.focusIn(canvaaas.this())">focusIn(id, cb)</button>
		<button type="button" onclick="canvaaas.focusOut()">focusOut(cb)</button>
		//
		<button type="button" onclick="canvaaas.focusable(window.prompt())">focusable(id, cb)</button>
		<button type="button" onclick="canvaaas.editable(canvaaas.this())">editable(id, cb)</button>
		<button type="button" onclick="canvaaas.drawable(canvaaas.this())">drawable(id, cb)</button>
		//
		<button type="button" onclick="canvaaas.unfocusable(canvaaas.this())">unfocusable(id, cb)</button>
		<button type="button" onclick="canvaaas.uneditable(canvaaas.this())">uneditable(id, cb)</button>
		<button type="button" onclick="canvaaas.undrawable(canvaaas.this())">undrawable(id, cb)</button>
		//
		<button type="button" onclick="canvaaas.remove(canvaaas.this())">remove(id, cb)</button>
		<button type="button" onclick="canvaaas.removeAll()">removeAll(cb)</button>
		//
		<button type="button" onclick="canvaaas.reset(canvaaas.this())">reset(id, cb)</button>
		//
		<script>
			var tmp1 = {
				lockAspectRatio: false
			}
		</script>
		<button type="button" onclick="canvaaas.config(tmp1)">setConfig(object, cb)</button>
		//
		<button type="button" onclick="canvaaas.canvas(512, 512)">canvas(512, 512, cb)</button>
		<button type="button" onclick="canvaaas.canvas(1920, 1080)">canvas(1920, 1080, cb)</button>
		<button type="button" onclick="canvaaas.canvas(1080, 1920)">canvas(1080, 1920, cb)</button>
		//
		<button type="button" onclick="canvaaas.hideContainer()">hideContainer(cb)</button>
		<button type="button" onclick="canvaaas.showContainer()">showContainer(cb)</button>
		//
		<button type="button" onclick="canvaaas.stop()">stop(cb)</button>
		<button type="button" onclick="canvaaas.resume()">resume(cb)</button>
		//
		<button type="button" onclick="canvaaas.setFillColor('#000000')">setFillColor("000000", cb)</button>
		<button type="button" onclick="canvaaas.setFillColor('FFFFFF')">setFillColor('FFFFFF', cb)</button>
		<button type="button" onclick="canvaaas.setFillColor('alpha')">setFillColor('alpha', cb)</button>
		<button type="button" onclick="canvaaas.unsetFillColor()">unsetFillColor(cb)</button>
		//
		<button type="button" onclick="canvaaas.lockAspectRatio()">lockAspectRatio(cb)</button>
		<button type="button" onclick="canvaaas.unlockAspectRatio()">unlockAspectRatio(cb)</button>
		//
		<script>
			var tmp2 = {
				width: 256,
				fillColor: "#123456",
				mimeType: "image/png",
				quality: 1,
				smoothingQuality: "high",
				smoothingEnabled: true,
			}
		</script>
		<button type="button" onclick="canvaaas.draw()">draw(cb)</button>
		<button type="button" onclick="canvaaas.drawTo(tmp2)">drawTo(options, cb)</button>
		//
		<button type="button" onclick="canvaaas.freeze()">freeze(cb)</button>
		<button type="button" onclick="canvaaas.escapeFreeze()">escapeFreeze(cb)</button>
		//
		<script>
			var tmp3 = {
				width: 256,
				fillColor: "#123456",
				mimeType: "image/png",
				quality: 1,
				smoothingQuality: "high",
				smoothingEnabled: true,
			}
		</script>
		<button type="button" onclick="canvaaas.download()">download(cb)</button>
		<button type="button" onclick="canvaaas.downloadTo(tmp3)">downloadTo(options, cb)</button>
		//
		<button type="button" onclick="canvaaas.this(console.log)">this(cb)</button>
		<button type="button" onclick="canvaaas.getThisData(console.log)">getThisData(cb)</button>
		//
		<button type="button" onclick="canvaaas.getConfigData(console.log)">getConfigData(cb)</button>
		<button type="button" onclick="canvaaas.getContainerData(console.log)">getContainerData(cb)</button>
		<button type="button" onclick="canvaaas.getCanvasData(console.log)">getCanvasData(cb)</button>
		<button type="button" onclick="canvaaas.getImageData(canvaaas.this(), console.log)">getImageData(cb)</button>
		<button type="button" onclick="canvaaas.getImageDataAll(console.log)">getImageDataAll(cb)</button>
		//
		<button type="button" onclick="canvaaas.undo()">undo(cb)</button>
		<button type="button" onclick="canvaaas.redo()">redo(cb)</button>
		//
		<button type="button" onclick="canvaaas.init(elem)">init()</button>
		<button type="button" onclick="canvaaas.destroy()">destroy()</button>
	</div>

	<div style="display: inline-block; width: 30%; border: 1px solid; font-size: 0px;">
		<img id="preview1" style="width: 100%;" src="" alt="">
	</div>
	<div style="position: relative; display: inline-block; width: 30%; overflow: hidden; border: 1px solid; font-size: 0px;">
		<img id="preview2" style="width: 100%;" src="" alt="">
	</div>
	<div style="display: inline-block; width: 30%; border: 1px solid; font-size: 0px;">
		<img id="preview3" style="width: 100%;" src="" alt="">
	</div>
	

	<script>

		var inputs = {
			width: document.getElementById("width"),
			height: document.getElementById("height"),
			x: document.getElementById("axisX"),
			y: document.getElementById("axisY"),
			rotate: document.getElementById("rotate"),
			scaleX: document.getElementById("scaleX"),
			scaleY: document.getElementById("scaleY"),
			opacity: document.getElementById("opacity"),
			index: document.getElementById("index"),
			focusable: document.getElementById("focusable"),
			editable: document.getElementById("editable"),
			drawable: document.getElementById("drawable"),
		}
		var elem = document.getElementById("container");
		

		// test 1
		canvaaas.init(elem, {
			draw: function(err, res){
				if (err) {
					console.log(err);
					return false;
				}
				console.log("draw", res);
				document.getElementById("preview2").src = res.file;
			},
		}, function(err){
			if (err) {
				console.log(err);
			}	
		})

		// test 2
		// canvaaas.init(elem, {
		// 	initDrawWidth: 1000,
		// 	initDrawHeight: 1000,
		// 	draw: function(err, res){
		// 		if (err) {
		// 			console.log(err);
		// 			return false;
		// 		}
		// 		console.log("draw", res);
		// 		document.getElementById("preview1").src = res.file;
		// 	},
		// }, function(err){
		// 	if (err) {
		// 		console.log(err);
		// 	}	
		// })

		// test 3
		// canvaaas.init(elem, {
		// 	// initDrawWidth: 4000,
		// 	// initDrawHeight: 4000,
		// 	focus: function(err, res){
		// 		if (err) {
		// 			console.log(err);
		// 			return false;
		// 		}
		// 		var canvasState = canvaaas.getCanvasData();
		// 		var canvasAspectRatio = canvasState.originalWidth / canvasState.originalHeight;
		// 		var preview = document.getElementById("preview2");
		// 		var scaleRatio = preview.parentNode.offsetWidth / canvasState.originalWidth;
		// 		var state = canvaaas.getImageData(res);

		// 		preview.src = '/img/1.jpeg';
		// 		preview.parentNode.style.height = preview.parentNode.offsetWidth / canvasAspectRatio + "px";
		// 		preview.style.position = "absolute";
		// 		preview.style.width = state.width * scaleRatio + "px";
		// 		preview.style.height = state.height * scaleRatio + "px";
		// 		preview.style.left = (state.x - (state.width * 0.5)) * scaleRatio + "px";
		// 		preview.style.top = (state.y - (state.height * 0.5)) * scaleRatio + "px";
		// 		var transform = "";
		// 		transform += "scaleX(" + state.scaleX + ")";
		// 		transform += "scaleY(" + state.scaleY + ")";
		// 		transform += "rotate(" + state.rotate + "deg)";
		// 		preview.style.transform = transform;

		// 		inputs.width.value = state.width;
		// 		inputs.height.value = state.height;
		// 		inputs.x.value = state.x;
		// 		inputs.y.value = state.y;
		// 		inputs.index.value = state.index;
		// 		inputs.rotate.value = state.rotate;
		// 		inputs.scaleX.value = state.scaleX;
		// 		inputs.scaleY.value = state.scaleY;
		// 		inputs.opacity.value = state.opacity;
		// 		inputs.focusable.value = state.focusable;
		// 		inputs.editable.value = state.editable;
		// 		inputs.drawable.value = state.drawable;
		// 	},
		// 	edit: function(err, res){
		// 		if (err) {
		// 			console.log(err);
		// 			return false;
		// 		}
		// 		// console.log("edit", res);
		// 		var canvasState = canvaaas.getCanvasData();
		// 		var canvasAspectRatio = canvasState.originalWidth / canvasState.originalHeight;
		// 		var preview = document.getElementById("preview2");
		// 		var scaleRatio = preview.parentNode.offsetWidth / canvasState.originalWidth;
		// 		var state = canvaaas.getImageData(res);

		// 		preview.src = '/img/1.jpeg';
		// 		preview.parentNode.style.height = preview.parentNode.offsetWidth / canvasAspectRatio + "px";
		// 		preview.style.position = "absolute";
		// 		preview.style.width = state.width * scaleRatio + "px";
		// 		preview.style.height = state.height * scaleRatio + "px";
		// 		preview.style.left = (state.x - (state.width * 0.5)) * scaleRatio + "px";
		// 		preview.style.top = (state.y - (state.height * 0.5)) * scaleRatio + "px";
		// 		var transform = "";
		// 		transform += "scaleX(" + state.scaleX + ")";
		// 		transform += "scaleY(" + state.scaleY + ")";
		// 		transform += "rotate(" + state.rotate + "deg)";
		// 		preview.style.transform = transform;

		// 		inputs.width.value = state.width;
		// 		inputs.height.value = state.height;
		// 		inputs.x.value = state.x;
		// 		inputs.y.value = state.y;
		// 		inputs.index.value = state.index;
		// 		inputs.rotate.value = state.rotate;
		// 		inputs.scaleX.value = state.scaleX;
		// 		inputs.scaleY.value = state.scaleY;
		// 		inputs.opacity.value = state.opacity;
		// 		inputs.focusable.value = state.focusable;
		// 		inputs.editable.value = state.editable;
		// 		inputs.drawable.value = state.drawable;
		// 	},
		// 	draw: function(err, res){
		// 		if (err) {
		// 			console.log(err);
		// 			return false;
		// 		}
		// 		console.log("draw", res);
		// 		document.getElementById("preview1").src = res.file;
		// 	},
		// }, function(err){
		// 	if (err) {
		// 		console.log(err);
		// 	}	
		// })

			
		var test1 = {
			// canvaaas.getImageData()
		    "canvasWidth": 5472,
		    "canvasHeight": 3648,
		    "width": 3768.2920643991088,
		    "height": 596.832113102849,
		    "left": 1831.0551775752149,
		    "top": 2099.6462515004105,
		    "x": 3715.2012097747693,
		    "y": 2398.062308051835,
		    "rotate": 328.0627994428064,
		    "scaleX": 1,
		    "scaleY": 1,
		    "opacity": 1,
		    "index": 0,
		    "focusable": true,
		    "editable": true,
		    "drawable": true
		}

		// test 4
		// canvaaas.init(elem, {
		// 	initDrawWidth: 2000,
		// 	initDrawHeight: 2073,
		// 	edit: function(err, res){
		// 		var state = canvaaas.getImageData(res);
		// 		inputs.width.value = state.width;
		// 		inputs.height.value = state.height;
		// 		inputs.x.value = state.x;
		// 		inputs.y.value = state.y;
		// 		inputs.index.value = state.index;
		// 		inputs.rotate.value = state.rotate;
		// 		inputs.scaleX.value = state.scaleX;
		// 		inputs.scaleY.value = state.scaleY;
		// 		inputs.opacity.value = state.opacity;
		// 		inputs.focusable.value = state.focusable;
		// 		inputs.editable.value = state.editable;
		// 		inputs.drawable.value = state.drawable;
		// 	},
		// 	draw: function(err, res){
		// 		if (err) {
		// 			console.log(err);
		// 			return false;
		// 		}
		// 		console.log("draw", res);
		// 		document.getElementById("preview1").src = res.file;
		// 	},
		// }, function(err){
		// 	if (err) {
		// 		console.log(err);
		// 	}
		// 	canvaaas.uploadUrls(['/img/1.jpeg'], test1, function(err){
		// 		if (err) {
		// 			console.log(err)
		// 		}
		// 	})
		// })

		// test 5
		// canvaaas.preview(elem, {
		// 	url: '/img/1.jpeg',
		// 	state: {
		// 		"canvasWidth": 5472,
		// 	    "canvasHeight": 3648,
		// 	    "width": 3768.2920643991088,
		// 	    "height": 596.832113102849,
		// 	    "left": 1831.0551775752149,
		// 	    "top": 2099.6462515004105,
		// 	    "x": 3715.2012097747693,
		// 	    "y": 2398.062308051835,
		// 	    "rotate": 328.0627994428064,
		// 	    "scaleX": 1,
		// 	    "scaleY": 1,
		// 	    "opacity": 1,
		// 	}
		// }, function(err){
		// 	if (err) {
		// 		console.log(err);
		// 	}
		// })

		// test 6
		// canvaaas.preview(
		// 	elem,
		// 	['/img/1.jpeg'],
		// 	[{
		// 		"canvasWidth": 5472,
		// 	    "canvasHeight": 3648,
		// 	    "width": 3768.2920643991088,
		// 	    "height": 596.832113102849,
		// 	    "left": 1831.0551775752149,
		// 	    "top": 2099.6462515004105,
		// 	    "x": 3715.2012097747693,
		// 	    "y": 2398.062308051835,
		// 	    "rotate": 328.0627994428064,
		// 	    "scaleX": 1,
		// 	    "scaleY": 1,
		// 	    "opacity": 1,
		// 	}], function(err, res){
		// 	if (err) {
		// 		console.log(err);
		// 	}
		// 	console.log(res)
		// })

		var test2 = [
		    {
		        "canvasWidth": 4032,
		        "canvasHeight": 3024,
		        "src": "/img/3.jpg",
		        "width": 3911.961907399141,
		        "height": 2933.971430549356,
		        "x": 2114.9767441860463,
		        "y": 1501.581395348837,
		        "rotate": 0,
		        "scaleX": 1,
		        "scaleY": 1,
		        "opacity": 1,
		        "index": 0,
		        "focusable": true,
		        "editable": true,
		        "drawable": true
		    },
		    {
		        "canvasWidth": 4032,
		        "canvasHeight": 3024,
		        "src": "/img/3.jpeg",
		        "width": 1835.8343049688174,
		        "height": 2447.779073291754,
		        "x": 747.7636254672568,
		        "y": 2079.813953488372,
		        "rotate": 335.5923831769435,
		        "scaleX": 1,
		        "scaleY": 1,
		        "opacity": 1,
		        "index": 1,
		        "focusable": true,
		        "editable": true,
		        "drawable": true
		    },
		    {
		        "canvasWidth": 4032,
		        "canvasHeight": 3024,
		        "src": "/img/3.png",
		        "width": 1591.309449421528,
		        "height": 1591.309449421528,
		        "x": 2896.3720930232557,
		        "y": 1905.84685605785,
		        "rotate": -335.54985541284424,
		        "scaleX": 1,
		        "scaleY": 1,
		        "opacity": 0.5,
		        "index": 2,
		        "focusable": true,
		        "editable": true,
		        "drawable": true
		    }
		]

		// test 7
		// canvaaas.preview(
		// 	elem,
		// 	test2, function(err, res){
		// 	if (err) {
		// 		console.log(err);
		// 	}
		// 	console.log(res)
		// })
		

	</script>
</body>
</html>