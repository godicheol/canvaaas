<!DOCTYPE html>
<html>
<head>
<title>canvaaas</title>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- ! -->
<meta name="viewport" content="width=device-width, initial-scale=1"> 
<link rel='stylesheet' href='./dist/canvaaas.css' />
<script src="./dist/canvaaas.js"></script>
<!-- ! -->

<style>
	html,
	body,
	div{
		margin: 0;
		padding: 0;
	}

	#container{
		padding: 24px;
		overflow: hidden;
		/*background-color: #000;*/
	}

	#logger{
		display: inline-block;
		width: 48%;
		height: 300px;
		vertical-align: top;
		overflow-y: scroll;
	}
	#logger th{
		text-align: right;
	}

	#logger input{
		max-width: 100%;
	}

	#buttons{
		display: inline-block;
		width: 48%;
		height: 300px;
		padding-bottom: 300px;
		overflow-y: scroll;
	}

	input[type='file']{
		display: none;
	}
	label,
	button{
		font-family: arial;
		padding: 3px 6px;
		font-size: 14px;
		border: 1px solid #777;
		border-radius: 2px;
		background-color: #e7e7e7;
		cursor: pointer;
	}
	label:hover,
	button:hover{
		background-color: #c7c7c7;
	}
	label:active,
	button:active{
		background-color: #e7e7e7;
	}

	.header{
		position: absolute;
		top: 0;
		left: 0;
		right: 0;
		font-size: 0;
		font-family: sans-serif;
	}
	.header-hidden{
		display: none;
	}
	.header-tab{
		position: relative;
		display: inline-block;
		vertical-align: top;
		width: auto;
	}
	.header-subject{
		display: block;
		color: inherit;
		text-decoration: none;
		font-size: 0.8rem;
		font-weight: 700;
		padding: 3px 12px;
		cursor: default;
	}
	.header-tab:hover .header-subject{
		background-color: #e7e7e7;
	}
	.header-list{
		position: absolute;
		list-style: none;
		min-width: 150px;
		margin: 0 6px;
		padding: 6px 6px;
		background-color: #171717;
		max-height: 500px;
		z-index: 999;
		overflow-y: auto;
	}
	.header-list.hidden{
		display: none;
	}
	.header-list a,
	.header-list label{
		display: block;
		color: #e7e7e7;
		text-decoration: none;
		padding: 6px 6px;
		margin: 0px;
		cursor: default;
		background-color: rgba(0,0,0,0);
		border: 0;
		border-radius: 0;
		font-size: 0.8rem;
	}
	.header-list a:hover,
	.header-list label:hover{
		background-color: #373737;
	}
	.header-list li.rule{
		margin: 6px;
		border-top: 1px solid #575757;
		color: #e7e7e7;
	}

	.logger{
		padding-top: 20px;
	}
	.container-data,
	.canvas-data,
	.image-data{
		font-size: 0.8rem;
	}

	.container-data.hidden,
	.canvas-data.hidden,
	.image-data.hidden{
		display: none;
	}

	.container-data input,
	.canvas-data input,
	.image-data input{
		width: 50px;
		text-align: right;
	}

	.logger #canvas-backgroundColor{
		display: inline-block;
		width: 50px;
		height: 20px;
		border: 1px solid #878787;
		border-radius: 3px;
		vertical-align: middle;
	}
</style>
</head>
<body style="">

	<div id="header" class="header">
		<div class="header-hidden">
			<input id="uploadSingle" type="file" onchange="canvaaas.uploadFiles(this, console.log)">
			<input id="uploadMultiple" type="file" onchange="canvaaas.uploadFiles(this, console.log)" multiple>
			<button id="moveTopLeft" onclick="canvaaas.moveTo(canvaaas.this(), 'left', 'top')"></button>
			<button id="moveTopCenter" onclick="canvaaas.moveTo(canvaaas.this(), 'center', 'top')"></button>
			<button id="moveTopRight" onclick="canvaaas.moveTo(canvaaas.this(), 'right', 'top')"></button>
			<button id="moveMiddleLeft" onclick="canvaaas.moveTo(canvaaas.this(), 'left', 'middle')"></button>
			<button id="moveMiddleCenter" onclick="canvaaas.moveTo(canvaaas.this(), 'center', 'middle')"></button>
			<button id="moveMiddleRight" onclick="canvaaas.moveTo(canvaaas.this(), 'right', 'middle')"></button>
			<button id="moveBottomLeft" onclick="canvaaas.moveTo(canvaaas.this(), 'left', 'bottom')"></button>
			<button id="moveBottomCenter" onclick="canvaaas.moveTo(canvaaas.this(), 'center', 'bottom')"></button>
			<button id="moveBottomRight" onclick="canvaaas.moveTo(canvaaas.this(), 'right', 'bottom')"></button>
		</div>
		<div class="header-tab">
			<a href="javascript:void(0)" class="header-subject">Canvaaas.js</a>
			<ul class="header-list hidden">
				<li><a href="javascript:void(0)" onclick="alert('Created by eeecheol@gmail.com')">About Canvaaas</a></li>
			</ul>
		</div>
		<div class="header-tab">
			<a href="javascript:void(0)" class="header-subject">File</a>
			<ul class="header-list hidden">
				<li><label for="uploadSingle">Upload File</label></li>
				<li><label for="uploadMultiple">Upload Files</label></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.uploadUrl(window.prompt('Type image URL.'), console.log)
				">Upload URL</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.remove(canvaaas.this())
				">Remove</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.removeAll()
				">Remove All</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					// download 
					canvaaas.draw(null, function(err, res){
						var link = document.createElement('a');
						link.setAttribute('href', res.file);
						link.setAttribute('download', 'untitled');
						link.style.display = 'none';
						document.body.appendChild(link);
						link.click();
						document.body.removeChild(link);
						window.URL.revokeObjectURL(res.file);
					})
				">Save</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					// new tab
					canvaaas.draw(null, function(err, res){
						var image = new Image();
						image.src = res.file;
						image.style.maxWidth = '100%';
						image.style.maxHeight = '100%';

				        var newTab = window.open('');
				        newTab.document.write(image.outerHTML);

						window.URL.revokeObjectURL(res.file);
					})
				">Draw to New Tab</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.getContainerData(function(err, res){
						alert(JSON.stringify(res));
					})
				">Get Container Data</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.getCanvasData(function(err, res){
						alert(JSON.stringify(res));
					})
				">Get Canvas Data</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.getImageDataAll(function(err, res){
						alert(JSON.stringify(res));
					})
				">Get Image Data</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.getCacheData(function(err, res){
						alert(JSON.stringify(res));
					})
				">Get Cache Data</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.config(testConfig1, function(err, res){
						canvaaas.init(elem)
					})
				">Init</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.destroy(function(err, res){
						if (err) {
							console.log(err);
							return false;
						}
					})
				">Destroy</a></li>
			</ul>
		</div>
		<div class="header-tab">
			<a href="javascript:void(0)" class="header-subject">Edit</a>
			<ul class="header-list hidden">
				<li><a id="undo" href="javascript:void(0)" onclick="
					canvaaas.undo(console.log)
				">Undo</a></li>
				<li><a id="redo" href="javascript:void(0)" onclick="
					canvaaas.redo(console.log)
				">Redo</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.moveY(canvaaas.this(), 10)
				">Move Top</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.moveY(canvaaas.this(), -10)
				">Move Bottom</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.moveX(canvaaas.this(), 10)
				">Move Left</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.moveX(canvaaas.this(), -10)
				">Move Right</a></li>
				<li class="rule"></li>
				<li><label for="moveTopLeft">Move top-left</label></li>
				<li><label for="moveTopCenter">Move top-center</label></li>
				<li><label for="moveTopRight">Move top-right</label></li>
				<li><label for="moveMiddleLeft">Move middle-left</label></li>
				<li><label for="moveMiddleCenter">Move middle-center</label></li>
				<li><label for="moveMiddleRight">Move middle-right</label></li>
				<li><label for="moveBottomLeft">Move bottom-left</label></li>
				<li><label for="moveBottomCenter">Move bottom-center</label></li>
				<li><label for="moveBottomRight">Move bottom-right</label></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.resize(
						canvaaas.this(),
						window.prompt('Type new width(px).'),
						window.prompt('Type new height(px).')
					)
				">Resize</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.zoom(canvaaas.this(), 0.1)
				">Zoom In</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.zoom(canvaaas.this(), -0.1)
				">Zoom Out</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.zoomTo(canvaaas.this(), 0.01)
				">Zoom 0.01</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.zoomTo(canvaaas.this(), 0.1)
				">Zoom 0.1</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.zoomTo(canvaaas.this(), 1)
				">Zoom 1</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.zoomTo(canvaaas.this(), 'cover')
				">Zoom Cover</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.zoomTo(canvaaas.this(), 'contain')
				">Zoom Contain</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.rotate(canvaaas.this(), -45)
				">Rotate Left</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.rotate(canvaaas.this(), 45)
				">Rotate Right</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.rotateTo(canvaaas.this(), 0)
				">Rotate Reset</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.flipX(canvaaas.this())
				">Flip Horizontally</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.flipY(canvaaas.this())
				">Flip Vertically</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.flipTo(canvaaas.this(), 1, 1)
				">Flip Reset</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.opacityTo(canvaaas.this(), window.prompt('0 ~ 1'))
				">Opacity</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.toggleAspectRatio(canvaaas.this())
				">Toggle Aspect Ratio</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.lockAspectRatio(canvaaas.this())
				">Lock Aspect Ratio</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.unlockAspectRatio(canvaaas.this())
				">Unlock Aspect Ratio</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.indexTo(canvaaas.this(), window.prompt('Number'))
				">Index</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.indexUp(canvaaas.this())
				">Index Up</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.indexDown(canvaaas.this())
				">Index Down</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.focusIn(window.prompt('ID'))
				">Focus In</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.focusOut()
				">Focus Out</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.toggleFocusable(canvaaas.this())
				">Toggle Focus</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.toggleEditable(canvaaas.this())
				">Toggle Edit</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.toggleDrawable(canvaaas.this())
				">Toggle Draw</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.focusable(canvaaas.this())
				">Enable Focus</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.editable(canvaaas.this())
				">Enable Edit</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.drawable(canvaaas.this())
				">Enable Draw</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.unfocusable(canvaaas.this())
				">Disable Focus</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.uneditable(canvaaas.this())
				">Disable Edit</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.undrawable(canvaaas.this())
				">Disable Draw</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.reset(canvaaas.this())
				">Reset</a></li>
			</ul>
		</div>
		<div class="header-tab">
			<a href="javascript:void(0)" class="header-subject">Canvas</a>
			<ul class="header-list hidden">
				<li><a href="javascript:void(0)" onclick="
					canvaaas.freeze()
				">Freeze</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.thaw()
				">Thaw</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.canvas(
						window.prompt('Type new canvas width(px).'),
						window.prompt('Type new canvas height(px).')
					)
				">Canvas Size</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.mimeType(window.prompt('e.g. `jpg`'))
				">MimeType</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.quality(window.prompt('e.g. 0 ~ 1'))
				">Quality</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.backgroundColor(window.prompt('e.g. #FFFFFF'))
				">Background Color</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.smoothingEnabled(window.prompt('e.g. 0 ~ 1'))
				">Smooth Enabled</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.smoothingQuality(window.prompt('e.g. 0 ~ 1'))
				">Smooth Quality</a></li>
			</ul>
		</div>
		<div class="header-tab">
			<a href="javascript:void(0)" class="header-subject">View</a>
			<ul class="header-list hidden">
				<li><a href="javascript:viewContainerData()">View Container Data</a></li>
				<li><a href="javascript:viewCanvasData()">View Canvas Data</a></li>
				<li><a href="javascript:viewImageData()">View Image Data</a></li>
			</ul>
		</div>

		<script>
			function viewImageData() {
				var elem = document.querySelector("div.image-data");
				if (elem.classList.contains("hidden") === true) {
					elem.classList.remove("hidden");
				} else {
					elem.classList.add("hidden");
				}
			}

			function viewContainerData() {
				var elem = document.querySelector("div.container-data");
				if (elem.classList.contains("hidden") === true) {
					elem.classList.remove("hidden");
				} else {
					elem.classList.add("hidden");
				}
			}

			function viewCanvasData() {
				var elem = document.querySelector("div.canvas-data");
				if (elem.classList.contains("hidden") === true) {
					elem.classList.remove("hidden");
				} else {
					elem.classList.add("hidden");
				}
			}
			(function(){
				var header = document.getElementById("header");
				var tabs = header.querySelectorAll("a.header-subject");
				var opened;

				tabs.forEach(function(t){
					t.addEventListener("click", function(e){
						e.preventDefault();
						e.stopPropagation();

						var isThis = false;
						var list = e.target.parentNode.querySelector(".header-list");

						if (opened !== undefined && opened !== null) {
							if (opened.isSameNode(list)) {
								isThis = true;
							}
							opened.classList.add("hidden");
							opened = undefined;
						}

						if (isThis === true) {
							return false;
						}

						if (list.classList.contains("hidden") === true) {
							list.classList.remove("hidden");
							opened = list;
						}
					});
				});
			})();
		</script>
	</div>

	<div class="logger">
		<div class="container-data hidden">
			Left:
			<input id="container-left" type="text">
			Top:
			<input id="container-top" type="text">
			Width:
			<input id="container-width" type="text">
			Height:
			<input id="container-height" type="text">
		</div>
		<div class="canvas-data hidden">
			X:
			<input id="canvas-x" type="text">
			Y:
			<input id="canvas-y" type="text">
			Width:
			<input id="canvas-width" type="text">
			Height:
			<input id="canvas-height" type="text">
			Background:
			<div id="canvas-backgroundColor"></div>
			MimeType:
			<input id="canvas-mimeType" type="text">
			Quality:
			<input id="canvas-quality" type="text">
			SmoothingQuality:
			<input id="canvas-smoothingQuality" type="text">
			SmoothingEnabled:
			<input id="canvas-smoothingEnabled" type="text">
		</div>
		<div class="image-data hidden">
			X:
			<input id="image-x" type="text">
			Y:
			<input id="image-y" type="text">
			Width:
			<input id="image-width" type="text">
			Height:
			<input id="image-height" type="text">
			Rotate:
			<input id="image-rotate" type="text">
			ScaleX:
			<input id="image-scaleX" type="text">
			ScaleY:
			<input id="image-scaleY" type="text">
			Opacity:
			<input id="image-opacity" type="text">
			Index:
			<input id="image-index" type="text">
			LockAspectRatio
			<input id="image-lockAspectRatio" type="text">
			Focusable:
			<input id="image-focusable" type="text">
			Editable:
			<input id="image-editable" type="text">
			Drawable:
			<input id="image-drawable" type="text">
		</div>
	</div>

	<div id="container"></div>

	<script>

		var inputs = {
			container: {
				width: document.getElementById("container-width"),
				height: document.getElementById("container-height"),
				left: document.getElementById("container-left"),
				top: document.getElementById("container-top"),
			},
			canvas:{
				width: document.getElementById("canvas-width"),
				height: document.getElementById("canvas-height"),
				x: document.getElementById("canvas-x"),
				y: document.getElementById("canvas-y"),
				quality: document.getElementById("canvas-quality"),
				mimeType: document.getElementById("canvas-mimeType"),
				backgroundColor: document.getElementById("canvas-backgroundColor"),
				smoothingEnabled: document.getElementById("canvas-smoothingEnabled"),
				smoothingQuality: document.getElementById("canvas-smoothingQuality"),
			},
			image:{
				width: document.getElementById("image-width"),
				height: document.getElementById("image-height"),
				x: document.getElementById("image-x"),
				y: document.getElementById("image-y"),
				rotate: document.getElementById("image-rotate"),
				scaleX: document.getElementById("image-scaleX"),
				scaleY: document.getElementById("image-scaleY"),
				opacity: document.getElementById("image-opacity"),
				index: document.getElementById("image-index"),
				lockAspectRatio: document.getElementById("image-lockAspectRatio"),
				focusable: document.getElementById("image-focusable"),
				editable: document.getElementById("image-editable"),
				drawable: document.getElementById("image-drawable"),
			}	
		}

		var buttons = {
			undo: document.getElementById("undo"),
			redo: document.getElementById("redo"),
		}

		var elem = document.getElementById("container");

		var testStates1 = [{
	        "src": "/img/3.jpg",
	        "width": 3911.961907399141,
	        "height": 2933.971430549356,
	        "x": 2114.9767441860463,
	        "y": 1501.581395348837,
	        "rotate": 45,
	        "scaleX": 1,
	        "scaleY": 1,
	        "opacity": 1,
	        "index": 4,
	        "focusable": true,
	        "editable": true,
	        "drawable": true
	    }, {
	        "src": "/img/3.jpeg",
	        "width": 1835.8343049688174,
	        "height": 2447.779073291754,
	        "x": 747.7636254672568,
	        "y": 2079.813953488372,
	        "rotate": 335.5923831769435,
	        "scaleX": 1,
	        "scaleY": 1,
	        "opacity": 1,
	        "index": null,
	        "focusable": true,
	        "editable": true,
	        "drawable": true
	    }, {
	        "src": "/img/3.png",
	        "width": 1591.309449421528,
	        "height": 1591.309449421528,
	        "x": 2896.3720930232557,
	        "y": 1905.84685605785,
	        "rotate": -335.54985541284424,
	        "scaleX": 1,
	        "scaleY": 1,
	        "opacity": 0.5,
	        "index": null,
	        "lockAspectRatio": false,
	        "focusable": true,
	        "editable": true,
	        "drawable": false
	    }, {
	        "src": "/img/1.png",
	        "width": 1591.309449421528,
	        "height": 1591.309449421528,
	        "x": 2896.3720930232557,
	        "y": 1905.84685605785,
	        "rotate": -335.54985541284424,
	        "scaleX": 1,
	        "scaleY": 1,
	        "opacity": 1,
	        "index": 3,
	        "lockAspectRatio": false,
	        "focusable": true,
	        "editable": true,
	        "drawable": false
	    }]

		var testConfig1 = {
			initCanvasWidth: 3911.961907399141,
			initCanvasHeight: 2933.971430549356,
			init: function(err, res){
				if (err) {
					console.log(err);
					return false;
				}
				console.log("config.init callback", res);
				var caches = canvaaas.getCacheData();
				if (caches.undo.length < 1) {
					buttons.undo.style.pointerEvents = "none";
					buttons.undo.style.cursor = "default";
					buttons.undo.style.color = "#777";
				} else {
					buttons.undo.style.pointerEvents = "";
					buttons.undo.style.cursor = "";
					buttons.undo.style.color = "";
				}
				if (caches.redo.length < 1) {
					buttons.redo.style.pointerEvents = "none";
					buttons.redo.style.cursor = "default";
					buttons.redo.style.color = "#777";
				} else {
					buttons.redo.style.pointerEvents = "";
					buttons.redo.style.cursor = "";
					buttons.redo.style.color = "";
				}
			},
			canvas: function(err, res){
				if (err) {
					console.log(err);
					return false;
				}
				console.log("config.canvas callback", res);
				var containerState = canvaaas.getContainerData();
				inputs.container.width.value = Math.floor(containerState.width * 100) / 100;
				inputs.container.height.value = Math.floor(containerState.height * 100) / 100;
				inputs.container.left.value = Math.floor(containerState.left * 100) / 100;
				inputs.container.top.value = Math.floor(containerState.top * 100) / 100;

				var canvasState = canvaaas.getCanvasData();
				inputs.canvas.width.value = Math.floor(canvasState.width * 100) / 100;
				inputs.canvas.height.value = Math.floor(canvasState.height * 100) / 100;
				inputs.canvas.x.value = Math.floor(canvasState.x * 100) / 100;
				inputs.canvas.y.value = Math.floor(canvasState.y * 100) / 100;
				inputs.canvas.mimeType.value = canvasState.mimeType;
				inputs.canvas.quality.value = canvasState.quality;
				inputs.canvas.backgroundColor.style.backgroundColor = canvasState.backgroundColor;
				inputs.canvas.smoothingEnabled.value = canvasState.smoothingEnabled;
				inputs.canvas.smoothingQuality.value = canvasState.smoothingQuality;
			},
			focus: function(err, res){
				if (err) {
					console.log(err);
					return false;
				}
				console.log("config.focus callback", res);
				var containerState = canvaaas.getContainerData();
				inputs.container.width.value = Math.floor(containerState.width * 100) / 100;
				inputs.container.height.value = Math.floor(containerState.height * 100) / 100;
				inputs.container.left.value = Math.floor(containerState.left * 100) / 100;
				inputs.container.top.value = Math.floor(containerState.top * 100) / 100;

				var canvasState = canvaaas.getCanvasData();
				inputs.canvas.width.value = Math.floor(canvasState.width * 100) / 100;
				inputs.canvas.height.value = Math.floor(canvasState.height * 100) / 100;
				inputs.canvas.x.value = Math.floor(canvasState.x * 100) / 100;
				inputs.canvas.y.value = Math.floor(canvasState.y * 100) / 100;
				inputs.canvas.mimeType.value = canvasState.mimeType;
				inputs.canvas.quality.value = canvasState.quality;
				inputs.canvas.backgroundColor.style.backgroundColor = canvasState.backgroundColor;
				inputs.canvas.smoothingEnabled.value = canvasState.smoothingEnabled;
				inputs.canvas.smoothingQuality.value = canvasState.smoothingQuality;

				var imageState = canvaaas.getImageData(res);
				inputs.image.width.value = Math.floor(imageState.width * 100) / 100;
				inputs.image.height.value = Math.floor(imageState.height * 100) / 100;
				inputs.image.x.value = Math.floor(imageState.x * 100) / 100;
				inputs.image.y.value = Math.floor(imageState.y * 100) / 100;
				inputs.image.index.value = imageState.index;
				inputs.image.rotate.value = Math.floor(imageState.rotate * 100) / 100;
				inputs.image.scaleX.value = imageState.scaleX;
				inputs.image.scaleY.value = imageState.scaleY;
				inputs.image.opacity.value = imageState.opacity;
				inputs.image.focusable.value = imageState.focusable;
				inputs.image.editable.value = imageState.editable;
				inputs.image.drawable.value = imageState.drawable;
			},
			edit: function(err, res){
				if (err) {
					console.log(err);
					return false;
				}
				console.log("config.edit callback", res);
				var caches = canvaaas.getCacheData();
				if (caches.undo.length < 1) {
					buttons.undo.style.pointerEvents = "none";
					buttons.undo.style.cursor = "default";
					buttons.undo.style.color = "#777";
				} else {
					buttons.undo.style.pointerEvents = "";
					buttons.undo.style.cursor = "";
					buttons.undo.style.color = "";
				}
				if (caches.redo.length < 1) {
					buttons.redo.style.pointerEvents = "none";
					buttons.redo.style.cursor = "default";
					buttons.redo.style.color = "#777";
				} else {
					buttons.redo.style.pointerEvents = "";
					buttons.redo.style.cursor = "";
					buttons.redo.style.color = "";
				}

				var imageState = canvaaas.getImageData(res);
				inputs.image.width.value = Math.floor(imageState.width * 100) / 100;
				inputs.image.height.value = Math.floor(imageState.height * 100) / 100;
				inputs.image.x.value = Math.floor(imageState.x * 100) / 100;
				inputs.image.y.value = Math.floor(imageState.y * 100) / 100;
				inputs.image.index.value = imageState.index;
				inputs.image.rotate.value = Math.floor(imageState.rotate * 100) / 100;
				inputs.image.scaleX.value = imageState.scaleX;
				inputs.image.scaleY.value = imageState.scaleY;
				inputs.image.opacity.value = imageState.opacity;
				inputs.image.lockAspectRatio.value = imageState.lockAspectRatio;
				inputs.image.focusable.value = imageState.focusable;
				inputs.image.editable.value = imageState.editable;
				inputs.image.drawable.value = imageState.drawable;
			},
			draw: function(err, res){
				if (err) {
					console.log(err);
					return false;
				}
				console.log("config.draw callback", res);
				// document.getElementById("preview1").src = res.file;
			},
		}


		// #0 config
		canvaaas.config(testConfig1);

		// #1 init
		canvaaas.init(elem, function(err, res){
			if (err) {
				console.log(err);
				return false;
			}
		})

		// #2
		testStates1.forEach(function(elem, idx){
			// elem.index = idx;
			canvaaas.uploadUrl(elem.src, function(err, res){
				if (err) {
					console.log(err);
					return false;
				}
				canvaaas.state(res, elem, function(err, res){
					if (err) {
						console.log(err);
						return false;
					}
				})
			})
		})


		// #1 init & freeze
		// canvaaas.init(elem, function(err, res){
		// 	if (err) {
		// 		console.log(err);
		// 		return false;
		// 	}
		// 	console.log(res);
		// 	// canvaaas.freeze();
		// })

	</script>
</body>
</html>