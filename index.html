<!DOCTYPE html>
<html>
<head>
<title>canvaaas</title>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- ! -->
<meta name="viewport" content="width=device-width, initial-scale=1"> 
<link rel='stylesheet' href='./dist/canvaaas.css' />
<script src="./dist/canvaaas.js"></script>
<!-- ! -->

<style>
	html,
	body,
	div{
		margin: 0;
		padding: 0;
	}

	#myContainer{
		padding: 24px;
		overflow: hidden;
		/*background-color: #000;*/
	}

	input[type='file']{
		display: none;
	}
	label,
	button{
		font-family: arial;
		padding: 3px 6px;
		font-size: 14px;
		border: 1px solid #777;
		border-radius: 2px;
		background-color: #e7e7e7;
		cursor: pointer;
	}
	label:hover,
	button:hover{
		background-color: #c7c7c7;
	}
	label:active,
	button:active{
		background-color: #e7e7e7;
	}

	.header{
		position: absolute;
		top: 0;
		left: 0;
		right: 0;
		font-size: 0;
		font-family: sans-serif;
	}
	.header-hidden{
		display: none;
	}
	.header-tab{
		position: relative;
		display: inline-block;
		vertical-align: top;
		width: auto;
	}
	.header-subject{
		display: block;
		color: inherit;
		text-decoration: none;
		font-size: 0.8rem;
		font-weight: 700;
		padding: 3px 12px;
		cursor: default;
	}
	.header-tab:hover .header-subject{
		background-color: #e7e7e7;
	}
	.header-list{
		position: absolute;
		list-style: none;
		min-width: 150px;
		margin: 0 6px;
		padding: 6px 6px;
		background-color: #171717;
		max-height: 500px;
		z-index: 999;
		overflow-y: auto;
	}
	.header-list.hidden{
		display: none;
	}
	.header-list a,
	.header-list label{
		display: block;
		color: #e7e7e7;
		text-decoration: none;
		padding: 6px 6px;
		margin: 0px;
		cursor: default;
		background-color: rgba(0,0,0,0);
		border: 0;
		border-radius: 0;
		font-size: 0.8rem;
	}
	.header-list a:hover,
	.header-list label:hover{
		background-color: #373737;
	}
	.header-list li.rule{
		margin: 6px;
		border-top: 1px solid #575757;
		color: #e7e7e7;
	}

	.logger{
		padding-top: 20px;
	}
	.container-data,
	.canvas-data,
	.image-data{
		font-size: 0.8rem;
	}

	.container-data.hidden,
	.canvas-data.hidden,
	.image-data.hidden{
		display: none;
	}

	.container-data input,
	.canvas-data input,
	.image-data input{
		width: 50px;
		text-align: right;
		font-size: 0.8rem;
	}

	.logger #canvas-backgroundColor{
		display: inline-block;
		width: 50px;
		height: 20px;
		border: 1px solid #878787;
		border-radius: 3px;
		vertical-align: middle;
	}
</style>
</head>
<body style="padding-top: 0px;">

	<div id="header" class="header">
		<div class="header-hidden">
			<input id="uploadSingle" type="file" onchange="canvaaas.uploadFiles(this)" accept="image/*">
			<input id="uploadMultiple" type="file" onchange="canvaaas.uploadFiles(this)" accept="image/*" multiple>
		</div>
		<div class="header-tab">
			<a href="javascript:void(0)" class="header-subject">Canvaaas.js</a>
			<ul class="header-list hidden">
				<li><a href="javascript:void(0)" onclick="alert('Created by eeecheol@gmail.com')">About Canvaaas</a></li>
			</ul>
		</div>
		<div class="header-tab">
			<a href="javascript:void(0)" class="header-subject">File</a>
			<ul class="header-list hidden">
				<li><label for="uploadSingle">Upload File</label></li>
				<li><label for="uploadMultiple">Upload Files</label></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.uploadUrl(
						window.prompt('Type image URL', '/img/1.jpg'),
						testImportData[0]
					)
				">Upload URL</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.uploadElement(
						document.getElementById(
							window.prompt('Type element ID', 'image-1')
						)
					)
				">Upload Element</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					// download 
					canvaaas.draw(null, function(err, res){
						var link = document.createElement('a');
						link.setAttribute('href', res.file);
						link.setAttribute('download', 'untitled');
						link.style.display = 'none';
						document.body.appendChild(link);
						link.click();
						document.body.removeChild(link);
						window.URL.revokeObjectURL(res.file);
					})
				">Save</a></li>
				<li><a href="javascript:void(0)" onclick="
					// download 
					canvaaas.draw({
						width: 256, 
						height: 256, 
						quality: 0.5,
						mimeType: 'png',
						backgroundColor: '#000000',
						smoothingQuality: 'high',
						smoothingEnabled: true
					}, function(err, res){
						var link = document.createElement('a');
						link.setAttribute('href', res.file);
						link.setAttribute('download', 'untitled');
						link.style.display = 'none';
						document.body.appendChild(link);
						link.click();
						document.body.removeChild(link);
						window.URL.revokeObjectURL(res.file);
					})
				">Save Thumbnail</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.export(function(err, res){
						if (err) {
							console.log(err);
							return false;
						}
						console.log('export callback', res);

						exportedData = res;
						exportedCanvasData = canvaaas.getCanvasData();

						canvaaas.removeAll();
					})
				">Export</a></li>
				<script>
					var exportedData;
					var exportedCanvasData;
				</script>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.canvas({
						width: exportedCanvasData.originalWidth,
						height: exportedCanvasData.originalHeight,
						unit: 'px',
						dpi: 1
					}, function(err, res){
						if (err) {
							console.log(err);
							return false;
						}
						canvaaas.import(exportedData, function(err, res){
							if (err) {
								console.log(err);
								return false;
							}
							console.log('import callback', res);
						})
					})
				">Import</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					// new tab
					canvaaas.draw(null, function(err, res){
						var image = new Image();
						image.src = res.file;
						image.style.maxWidth = '100%';
						image.style.maxHeight = '100%';

				        var newTab = window.open('');
				        newTab.document.write(image.outerHTML);

						window.URL.revokeObjectURL(res.file);
					})
				">Draw to New Tab</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.getConfigData(function(err, res){
						console.log(res);
						alert(JSON.stringify(res, null, 2));
					})
				">Get Config Data</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.getContainerData(function(err, res){
						console.log(res);
						alert(JSON.stringify(res, null, 2));
					})
				">Get Container Data</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.getCanvasData(function(err, res){
						console.log(res);
						alert(JSON.stringify(res, null, 2));
					})
				">Get Canvas Data</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.getImageDataAll(function(err, res){
						console.log(res);
						alert(JSON.stringify(res, null, 2));
					})
				">Get Image Data</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.getCacheData(function(err, res){
						console.log(res);
						alert(JSON.stringify(res, null, 2));
					})
				">Get Cache Data</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.config(testConfig1, function(err, res){
						canvaaas.init(elem)
					})
				">Init</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.destroy(function(err, res){
						if (err) {
							console.log(err);
							return false;
						}
					})
				">Destroy</a></li>
			</ul>
		</div>
		<div class="header-tab">
			<a href="javascript:void(0)" class="header-subject">Edit</a>
			<ul class="header-list hidden">
				<li><a id="undo" href="javascript:void(0)" onclick="
					canvaaas.undo(function(err, res){
						if (err) {
							console.log(err);
							return false;
						}
						checkCaches();
					})
				">Undo</a></li>
				<li><a id="redo" href="javascript:void(0)" onclick="
					canvaaas.redo(function(err, res){
						if (err) {
							console.log(err);
							return false;
						}
						checkCaches();
					})
				">Redo</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.id(canvaaas.this(), window.prompt('Type new ID'))
				">Set ID</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.moveY(canvaaas.this(), 10)
				">Move Top</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.moveY(canvaaas.this(), -10)
				">Move Bottom</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.moveX(canvaaas.this(), 10)
				">Move Left</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.moveX(canvaaas.this(), -10)
				">Move Right</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.moveTo(canvaaas.this(), 'left', 'top')
				">Move Top-Left</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.moveTo(canvaaas.this(), 'center', 'top')
				">Move Top-Center</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.moveTo(canvaaas.this(), 'right', 'top')
				">Move Top-Right</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.moveTo(canvaaas.this(), 'left', 'middle')
				">Move Middle-Left</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.moveTo(canvaaas.this(), 'center', 'middle')
				">Move Middle-Center</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.moveTo(canvaaas.this(), 'right', 'middle')
				">Move Middle-Right</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.moveTo(canvaaas.this(), 'left', 'bottom')
				">Move Bottom-Left</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.moveTo(canvaaas.this(), 'center', 'bottom')
				">Move Bottom-Center</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.moveTo(canvaaas.this(), 'right', 'bottom')
				">Move Bottom-Right</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.resize(
						canvaaas.this(),
						window.prompt('Type new width(px).', '256'),
						window.prompt('Type new height(px).', '256')
					)
				">Resize</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.zoom(canvaaas.this(), 0.1)
				">Zoom In</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.zoom(canvaaas.this(), -0.1)
				">Zoom Out</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.zoomTo(canvaaas.this(), 0.01)
				">Zoom 0.01</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.zoomTo(canvaaas.this(), 0.1)
				">Zoom 0.1</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.zoomTo(canvaaas.this(), 1)
				">Zoom 1</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.zoomTo(canvaaas.this(), 'cover')
				">Zoom Cover</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.zoomTo(canvaaas.this(), 'contain')
				">Zoom Contain</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.rotate(canvaaas.this(), -45)
				">Rotate Left</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.rotate(canvaaas.this(), 45)
				">Rotate Right</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.rotateTo(canvaaas.this(), 0)
				">Rotate Reset</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.flipX(canvaaas.this())
				">Flip Horizontally</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.flipY(canvaaas.this())
				">Flip Vertically</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.flipTo(canvaaas.this(), 1, 1)
				">Flip Reset</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.opacityTo(canvaaas.this(), window.prompt('0 ~ 1', '0.5'))
				">Opacity</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.toggleAspectRatio(canvaaas.this())
				">Toggle Aspect Ratio</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.lockAspectRatio(canvaaas.this())
				">Lock Aspect Ratio</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.unlockAspectRatio(canvaaas.this())
				">Unlock Aspect Ratio</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.indexTo(canvaaas.this(), window.prompt('Number', '5'))
				">Index To</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.index(canvaaas.this(), 1)
				">Index +1</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.index(canvaaas.this(), 3)
				">Index +3</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.index(canvaaas.this(), -1)
				">Index -1</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.index(canvaaas.this(), -3)
				">Index -3</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.focusIn(window.prompt('ID'))
				">Focus In</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.focusOut()
				">Focus Out</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.toggleFocusable(canvaaas.this())
				">Toggle Focus</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.toggleEditable(canvaaas.this())
				">Toggle Edit</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.toggleDrawable(canvaaas.this())
				">Toggle Draw</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.toggleIndexable(canvaaas.this())
				">Toggle Index</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.focusable(canvaaas.this())
				">Enable Focus</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.editable(canvaaas.this())
				">Enable Edit</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.drawable(canvaaas.this())
				">Enable Draw</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.indexable(canvaaas.this())
				">Enable Index</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.unfocusable(canvaaas.this())
				">Disable Focus</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.uneditable(canvaaas.this())
				">Disable Edit</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.undrawable(canvaaas.this())
				">Disable Draw</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.unindexable(canvaaas.this())
				">Disable Index</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.remove(canvaaas.this())
				">Remove</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.removeAll()
				">Remove All</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.reset(canvaaas.this())
				">Reset</a></li>
			</ul>
		</div>
		<div class="header-tab">
			<a href="javascript:void(0)" class="header-subject">Canvas</a>
			<ul class="header-list hidden">
				<li><a href="javascript:void(0)" onclick="
					canvaaas.freeze()
				">Freeze</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.thaw()
				">Thaw</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.canvas({
						width: window.prompt('Type width', '6'),
						height: window.prompt('Type height', '4'),
						unit: window.prompt('Type unit', 'in'),
						dpi: window.prompt('Type dpi', '300'),
					})
				">Canvas Size</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.mimeType(window.prompt('e.g. `jpg`', 'png'))
				">MimeType</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.quality(window.prompt('e.g. 0 ~ 1', '0.8'))
				">Quality</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.backgroundColor(window.prompt('e.g. #FFFFFF', '#000000'))
				">Background Color</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.smoothingEnabled(window.prompt('e.g. true, false', 'true'))
				">Smooth Enabled</a></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.smoothingQuality(window.prompt('e.g. log, middle, high', 'high'))
				">Smooth Quality</a></li>
				<li class="rule"></li>
				<li><a href="javascript:void(0)" onclick="
					canvaaas.checker(window.prompt('e.g. `true, false`', 'false'))
				">Background Checker</a></li>
			</ul>
		</div>
		<div class="header-tab">
			<a href="javascript:void(0)" class="header-subject">View</a>
			<ul class="header-list hidden">
				<li><a href="javascript:viewContainerData()">View Container Data</a></li>
				<li><a href="javascript:viewCanvasData()">View Canvas Data</a></li>
				<li><a href="javascript:viewImageData()">View Image Data</a></li>
			</ul>
		</div>
	</div>

	<div class="logger">
		<div class="container-data hidden">
			Is Initialized:
			<input id="container-isInitialized" type="text">
			Left:
			<input id="container-left" type="text">
			Top:
			<input id="container-top" type="text">
			Width:
			<input id="container-width" type="text">
			Height:
			<input id="container-height" type="text">
		</div>
		<div class="canvas-data hidden">
			Is Initialized:
			<input id="canvas-isInitialized" type="text">
			Original Width:
			<input id="canvas-originalWidth" type="text">
			Original Height:
			<input id="canvas-originalHeight" type="text">
			X:
			<input id="canvas-x" type="text">
			Y:
			<input id="canvas-y" type="text">
			Left:
			<input id="canvas-left" type="text">
			Top:
			<input id="canvas-top" type="text">
			Width:
			<input id="canvas-width" type="text">
			Height:
			<input id="canvas-height" type="text">
			Background:
			<div id="canvas-backgroundColor"></div>
			MimeType:
			<input id="canvas-mimeType" type="text">
			Quality:
			<input id="canvas-quality" type="text">
			Smoothing Quality:
			<input id="canvas-smoothingQuality" type="text">
			Smoothing Enabled:
			<input id="canvas-smoothingEnabled" type="text">
		</div>
		<div class="image-data hidden">
			ID:
			<input id="image-id" type="text">
			Type:
			<input id="image-type" type="text">
			Original Width:
			<input id="image-originalWidth" type="text">
			Original Height:
			<input id="image-originalHeight" type="text">
			X:
			<input id="image-x" type="text">
			Y:
			<input id="image-y" type="text">
			Left:
			<input id="image-left" type="text">
			Top:
			<input id="image-top" type="text">
			Width:
			<input id="image-width" type="text">
			Height:
			<input id="image-height" type="text">
			Rotate:
			<input id="image-rotate" type="text">
			ScaleX:
			<input id="image-scaleX" type="text">
			ScaleY:
			<input id="image-scaleY" type="text">
			Opacity:
			<input id="image-opacity" type="text">
			Index:
			<input id="image-index" type="text">
			LockAspectRatio
			<input id="image-lockAspectRatio" type="text">
			Focusable:
			<input id="image-focusable" type="text">
			Editable:
			<input id="image-editable" type="text">
			Drawable:
			<input id="image-drawable" type="text">
			Indexable:
			<input id="image-indexable" type="text">
		</div>
	</div>

	<div id="myContainer"></div>

	<div style="display: none;">
		<img
			id="image-1"
			src="/img/1.jpg"
			data-id = "test-1",
	        data-type = "url",
	        data-src = "./img/1.jpeg",
	        data-index = "1",
	        data-width = "7858.705673285891",
	        data-height = "5239.137115523928",
	        data-x = "2037.033467202142",
	        data-y = "1529.8313253012047",
	        data-rotate = "-338.99078178925924",
	        data-scaleX = "1",
	        data-scaleY = "-1",
	        data-opacity = "1",
	        data-lockAspectRatio = "true",
	        data-focusable = "true",
	        data-editable = "true",
	        data-drawable = "true",
	        data-indexable = "true",
		>
		<img 
			id="image-2" 
			src="/img/1.jpeg" 
			data-state='{"id":"test-2","index":1,"width":7858.705673285891,"height":5239.137115523928,"x":2037.033467202142,"y":1529.8313253012047,"rotate":-338.99078178925924,"scaleX":1,"scaleY":-1,"opacity":1,"lockAspectRatio":true,"focusable":true,"editable":true,"drawable":true,"indexable":true}'
		>
	</div>

	<script>
		function viewImageData() {
			var elem = document.querySelector("div.image-data");
			if (elem.classList.contains("hidden") === true) {
				elem.classList.remove("hidden");
			} else {
				elem.classList.add("hidden");
			}
		}

		function viewContainerData() {
			var elem = document.querySelector("div.container-data");
			if (elem.classList.contains("hidden") === true) {
				elem.classList.remove("hidden");
			} else {
				elem.classList.add("hidden");
			}
		}

		function viewCanvasData() {
			var elem = document.querySelector("div.canvas-data");
			if (elem.classList.contains("hidden") === true) {
				elem.classList.remove("hidden");
			} else {
				elem.classList.add("hidden");
			}
		}

		(function(){
			var header = document.getElementById("header");
			var tabs = header.querySelectorAll("a.header-subject");
			var opened;

			tabs.forEach(function(t){
				t.addEventListener("click", function(e){
					e.preventDefault();
					e.stopPropagation();

					var isThis = false;
					var list = e.target.parentNode.querySelector(".header-list");

					if (opened !== undefined && opened !== null) {
						if (opened.isSameNode(list)) {
							isThis = true;
						}
						opened.classList.add("hidden");
						opened = undefined;
					}

					if (isThis === true) {
						return false;
					}

					if (list.classList.contains("hidden") === true) {
						list.classList.remove("hidden");
						opened = list;
					}
				});
			});
		})();
	</script>

	<script>

		var inputs = {
			container: {
				isInitialized: document.getElementById("container-isInitialized"),
				width: document.getElementById("container-width"),
				height: document.getElementById("container-height"),
				left: document.getElementById("container-left"),
				top: document.getElementById("container-top"),
			},
			canvas:{
				isInitialized: document.getElementById("canvas-isInitialized"),
				originalWidth: document.getElementById("canvas-originalWidth"),
				originalHeight: document.getElementById("canvas-originalHeight"),
				width: document.getElementById("canvas-width"),
				height: document.getElementById("canvas-height"),
				left: document.getElementById("canvas-left"),
				top: document.getElementById("canvas-top"),
				x: document.getElementById("canvas-x"),
				y: document.getElementById("canvas-y"),
				quality: document.getElementById("canvas-quality"),
				mimeType: document.getElementById("canvas-mimeType"),
				backgroundColor: document.getElementById("canvas-backgroundColor"),
				smoothingEnabled: document.getElementById("canvas-smoothingEnabled"),
				smoothingQuality: document.getElementById("canvas-smoothingQuality"),
			},
			image:{
				id: document.getElementById("image-id"),
				type: document.getElementById("image-type"),
				originalWidth: document.getElementById("image-originalWidth"),
				originalHeight: document.getElementById("image-originalHeight"),
				width: document.getElementById("image-width"),
				height: document.getElementById("image-height"),
				left: document.getElementById("image-left"),
				top: document.getElementById("image-top"),
				x: document.getElementById("image-x"),
				y: document.getElementById("image-y"),
				rotate: document.getElementById("image-rotate"),
				scaleX: document.getElementById("image-scaleX"),
				scaleY: document.getElementById("image-scaleY"),
				opacity: document.getElementById("image-opacity"),
				index: document.getElementById("image-index"),
				lockAspectRatio: document.getElementById("image-lockAspectRatio"),
				focusable: document.getElementById("image-focusable"),
				editable: document.getElementById("image-editable"),
				drawable: document.getElementById("image-drawable"),
				indexable: document.getElementById("image-indexable"),
			}	
		}

		var buttons = {
			undo: document.getElementById("undo"),
			redo: document.getElementById("redo"),
		}

		var elem = document.getElementById("myContainer");

		var testImportData = [{
	        "id": "8fg880",
	        "type": "url",
	        "src": "./img/1.jpeg",
	        "index": 1,
	        "originalWidth": 5472,
	        "originalHeight": 3648,
	        "width": 7858.705673285891,
	        "height": 5239.137115523928,
	        "left": -1892.3193694408035,
	        "top": -1089.7372324607588,
	        "x": 2037.033467202142,
	        "y": 1529.8313253012047,
	        "rotate": -338.99078178925924,
	        "scaleX": 1,
	        "scaleY": -1,
	        "opacity": 1,
	        "lockAspectRatio": true,
	        "focusable": true,
	        "editable": true,
	        "drawable": true,
	        "indexable": true,
	    }, {
	        "id": "2pino4",
	        "type": "url",
	        "src": "./img/1.jpg",
	        "index": 2,
	        "originalWidth": 3024,
	        "originalHeight": 4032,
	        "width": 1114.5660428353656,
	        "height": 2131.2238618923093,
	        "left": 387.4101282337219,
	        "top": 464.68750456027334,
	        "x": 944.6931496514046,
	        "y": 1530.299435506428,
	        "rotate": -24.166508334467267,
	        "scaleX": 1,
	        "scaleY": 1,
	        "opacity": 1,
	        "lockAspectRatio": false,
	        "focusable": true,
	        "editable": false,
	        "drawable": true,
	        "indexable": true,
	    }, {
	        "id": "yrh5zx",
	        "type": "url",
	        "src": "./img/1.png",
	        "index": 3,
	        "originalWidth": 800,
	        "originalHeight": 800,
	        "width": 1265.9943059207653,
	        "height": 1265.9943059207653,
	        "left": 2615.9301961848964,
	        "top": 214.07549789433813,
	        "x": 3248.927349145279,
	        "y": 847.0726508547208,
	        "rotate": 333.87162287674744,
	        "scaleX": 1,
	        "scaleY": 1,
	        "opacity": 0.5,
	        "lockAspectRatio": true,
	        "focusable": true,
	        "editable": false,
	        "drawable": true,
	        "indexable": true,
	    }];

	    var testImportDataString = JSON.stringify(testImportData);

		var testConfig1 = {
			// filename: undefined, // string
			// allowedExtensions: [
			// 	"jpg",
			// 	"jpeg",
			// 	"png",
			// 	"webp",
			// 	"gif",
			// 	"svg",
			// 	"svg+xml",
			// 	"tiff",
			// 	"tif"
			// ], // array, jpg, jpeg, ,gif, png, webp, svg...
			// editable: true, // boolean
			// checker: true, // boolean
			// magneticRange: 5, // number, px
			// maxNumberOfImages: 999, // number
			// cacheLevels: 999, // number
			// containerAspectRatio: undefined, // number, width / height
			// minContainerWidth: undefined, // number, px
			// minContainerHeight: undefined, // number, px
			// maxContainerWidth: 1, // number, px, 0 ~ 1
			// maxContainerHeight: 0.7, // number, px, 0 ~ 1
			// minDrawWidth: 64, // number, px
			// minDrawHeight: 64, // number, px
			// maxDrawWidth: 4096, // number, px, for Mobile
			// maxDrawHeight: 4096, // number, px, for Mobile
			// minImageWidth: 64, // number, px
			// minImageHeight: 64, // number, px
			// maxImageWidth: undefined, // number, px
			// maxImageHeight: undefined, // number, px
			// renderImageType: "contain", // string, "cover", "contain"
			// renderImageWidth: 0.7, // number,  0 ~ 1
			// renderImageHeight: 0.7, // number, 0 ~ 1
			upload: function(err, res){
				if (err) {
					console.log(err);
					return false;
				}

				checkCaches();

				console.log("config.upload callback", res);
			},
			canvas: function(err, res) {
				if (err) {
					console.log(err);
					return false;
				}

				writeContainerData();
				writeCanvasData();
				checkCaches();

				console.log("config.canvas callback", res);
			},
			draw: function(err, res){
				if (err) {
					console.log(err);
					return false;
				}

				checkCaches();

				console.log("config.draw callback", res);
			},
			focusIn: function(err, res){
				if (err) {
					console.log(err);
					return false;
				}

				writeImageData(res);

				checkCaches();

				console.log("config.focusIn callback", res);
			}, 
			focusOut: function(err, res){
				if (err) {
					console.log(err);
					return false;
				}

				writeImageData();

				checkCaches();

				console.log("config.focusOut callback", res);
			},
			id: function(err, res){
				if (err) {
					console.log(err);
					return false;
				}
				console.log("config.id callback", res);

				writeImageData(res);

				checkCaches();
			},
			move: function(err, res){
				if (err) {
					console.log(err);
					return false;
				}
				console.log("config.move callback", res);

				writeImageData(res);

				checkCaches();
			},
			rotate: function(err, res){
				if (err) {
					console.log(err);
					return false;
				}
				console.log("config.rotate callback", res);

				writeImageData(res);

				checkCaches();
			},
			resize: function(err, res){
				if (err) {
					console.log(err);
					return false;
				}
				console.log("config.resize callback", res);

				writeImageData(res);

				checkCaches();
			},
			flip: function(err, res){
				if (err) {
					console.log(err);
					return false;
				}
				console.log("config.flip callback", res);

				writeImageData(res);

				checkCaches();
			},
			opacity: function(err, res){
				if (err) {
					console.log(err);
					return false;
				}
				console.log("config.opacity callback", res);

				writeImageData(res);

				checkCaches();
			},
			index: function(err, res){
				if (err) {
					console.log(err);
					return false;
				}
				console.log("config.index callback", res);

				writeImageData(res);

				checkCaches();

			},
			permission: function(err, res){
				if (err) {
					console.log(err);
					return false;
				}

				console.log("config.permission callback", res);

				writeImageData(res);

				checkCaches();
			},
			remove: function(err, res){
				if (err) {
					console.log(err);
					return false;
				}

				console.log("config.remove callback", res);

				checkCaches();
			},
		}

		// #0 config
		canvaaas.config(testConfig1);

		// #1 init
		canvaaas.init(elem, function(err, res){
			if (err) {
				console.log(err);
				return false;
			}

			console.log("init callback", res);
		});

		// #2 init canvas
		// canvaaas.canvas({
		// 	width: 6,
		// 	height: 4,
		// 	unit: "in",
		// 	dpi: 300
		// });

		// #3.1 import object
		// canvaaas.import(testImportData, function(err, res){
		// 	if (err) {
		// 		console.log(err);
		// 		return false;
		// 	}

		// 	writeContainerData();
		// 	writeCanvasData();

		// 	console.log("import callback", res);
		// });

		// #3.2 import string
		canvaaas.import(testImportDataString, function(err, res){
			if (err) {
				console.log(err);
				return false;
			}

			writeContainerData();
			writeCanvasData();

			checkCaches();

			console.log("import callback", res);
		});

		// 
		// log
		// 

		function writeContainerData(){
			var containerState = canvaaas.getContainerData();
			inputs.container.isInitialized.value = containerState.isInitialized;
			inputs.container.width.value = Math.floor(containerState.width * 100) / 100;
			inputs.container.height.value = Math.floor(containerState.height * 100) / 100;
			inputs.container.left.value = Math.floor(containerState.left * 100) / 100;
			inputs.container.top.value = Math.floor(containerState.top * 100) / 100;
		}

		function writeCanvasData(){
			var canvasState = canvaaas.getCanvasData();
			inputs.canvas.isInitialized.value = canvasState.isInitialized;
			inputs.canvas.originalWidth.value = Math.floor(canvasState.originalWidth * 100) / 100;
			inputs.canvas.originalHeight.value = Math.floor(canvasState.originalHeight * 100) / 100;
			inputs.canvas.width.value = Math.floor(canvasState.width * 100) / 100;
			inputs.canvas.height.value = Math.floor(canvasState.height * 100) / 100;
			inputs.canvas.left.value = Math.floor(canvasState.left * 100) / 100;
			inputs.canvas.top.value = Math.floor(canvasState.top * 100) / 100;
			inputs.canvas.x.value = Math.floor(canvasState.x * 100) / 100;
			inputs.canvas.y.value = Math.floor(canvasState.y * 100) / 100;
			inputs.canvas.mimeType.value = canvasState.mimeType;
			inputs.canvas.quality.value = canvasState.quality;
			inputs.canvas.backgroundColor.style.backgroundColor = canvasState.backgroundColor;
			inputs.canvas.smoothingEnabled.value = canvasState.smoothingEnabled;
			inputs.canvas.smoothingQuality.value = canvasState.smoothingQuality;
		}

		function writeImageData(imageState){
			if (!imageState) {
				inputs.image.id.value = "";
				inputs.image.type.value = "";
				inputs.image.originalWidth.value = "";
				inputs.image.originalHeight.value = "";
				inputs.image.width.value = "";
				inputs.image.height.value = "";
				inputs.image.left.value = "";
				inputs.image.top.value = "";
				inputs.image.x.value = "";
				inputs.image.y.value = "";
				inputs.image.index.value = "";
				inputs.image.rotate.value = "";
				inputs.image.scaleX.value = "";
				inputs.image.scaleY.value = "";
				inputs.image.opacity.value = "";
				inputs.image.lockAspectRatio.value = "";
				inputs.image.focusable.value = "";
				inputs.image.editable.value = "";
				inputs.image.drawable.value = "";
				inputs.image.indexable.value = "";
				return false;
			}
			inputs.image.id.value = imageState.id;
			inputs.image.type.value = imageState.type;
			inputs.image.originalWidth.value = Math.floor(imageState.originalWidth * 100) / 100;
			inputs.image.originalHeight.value = Math.floor(imageState.originalHeight * 100) / 100;
			inputs.image.width.value = Math.floor(imageState.width * 100) / 100;
			inputs.image.height.value = Math.floor(imageState.height * 100) / 100;
			inputs.image.left.value = Math.floor(imageState.left * 100) / 100;
			inputs.image.top.value = Math.floor(imageState.top * 100) / 100;
			inputs.image.x.value = Math.floor(imageState.x * 100) / 100;
			inputs.image.y.value = Math.floor(imageState.y * 100) / 100;
			inputs.image.index.value = imageState.index;
			inputs.image.rotate.value = Math.floor(imageState.rotate * 100) / 100;
			inputs.image.scaleX.value = imageState.scaleX;
			inputs.image.scaleY.value = imageState.scaleY;
			inputs.image.opacity.value = imageState.opacity;
			inputs.image.lockAspectRatio.value = imageState.lockAspectRatio;
			inputs.image.focusable.value = imageState.focusable;
			inputs.image.editable.value = imageState.editable;
			inputs.image.drawable.value = imageState.drawable;
			inputs.image.indexable.value = imageState.indexable;
		}

		function checkCaches(){
			var caches = canvaaas.getCacheData();
			if (caches.undo.length < 1) {
				buttons.undo.style.pointerEvents = "none";
				buttons.undo.style.cursor = "default";
				buttons.undo.style.color = "#777";
			} else {
				buttons.undo.style.pointerEvents = "";
				buttons.undo.style.cursor = "";
				buttons.undo.style.color = "";
			}
			if (caches.redo.length < 1) {
				buttons.redo.style.pointerEvents = "none";
				buttons.redo.style.cursor = "default";
				buttons.redo.style.color = "#777";
			} else {
				buttons.redo.style.pointerEvents = "";
				buttons.redo.style.cursor = "";
				buttons.redo.style.color = "";
			}
		}

	</script>
</body>
</html>